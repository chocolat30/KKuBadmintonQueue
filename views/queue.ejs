<!DOCTYPE html>
<html>

<head>
  <title>Badminton Queue</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>

<body class="bg-light">

  <div class="container mt-4">

    <h1 class="text-center mb-4">Badminton Queue</h1>

    <!-- Join Queue -->
    <form action="/join" method="POST" class="mb-4">
      <div class="input-group">
        <input type="text" name="name" class="form-control" placeholder="Pair name" required>
        <button class="btn btn-primary">Join Queue</button>
      </div>
    </form>

    <!-- Admin Controls -->
    <div class="mb-4">
      <a href="/start" class="btn btn-primary me-2">Start Match</a>
      <a href="/end?w=A" class="btn btn-success me-2">Team A Won</a>
      <a href="/end?w=B" class="btn btn-danger me-2">Team B Won</a>
      <a href="/history" class="btn btn-secondary me-2">Match History</a>
      <a href="/clear-queue" class="btn btn-warning me-2"
        onclick="return confirm('Are you sure you want to clear the entire queue?');">
        Clear Queue
      </a>
      <a href="/reset-match" class="btn btn-warning ms-2">Reset Match</a>

    </div>

    <!-- Current Match -->
    <h3>Current Match</h3>
    <ul class="list-group mb-4">
      <% if (match.length===0) { %>
        <li class="list-group-item">No active match</li>
        <% } else { %>
          <% match.forEach(m=> { %>
            <li class="list-group-item">
              <div class="fw-bold text-primary">Active Match</div>

              <div class="mt-2">
                <span class="badge bg-success">Team A: <%= m.teamA %></span>
              </div>

              <div class="mt-2">
                <span class="badge bg-danger">Team B: <%= m.teamB %></span>
              </div>

              <div class="mt-2 text-muted">
                Started at: <%= new Date(Number(m.timestamp)).toLocaleString('en-GB') %>
              </div>
            </li>
            <% }) %>
              <% } %>
    </ul>

    <!-- Queue -->
    <h3>Queue</h3>
    <ul class="list-group">
      <% if (queue.length===0) { %>
        <li class="list-group-item">Queue is empty</li>
        <% } else { %>
          <% queue.forEach((q, i)=> { %>
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <span>
                <strong>
                  <%= i+1 %>.
                </strong>
                <%= q.name %>
              </span>

              <a href="/remove/<%= q.id %>" class="btn btn-sm btn-outline-danger">
                Remove
              </a>
            </li>
            <% }) %>
              <% } %>
    </ul>

    <!-- Alerts -->
    <% if (msg==='active' ) { %>
      <div class="alert alert-warning">A match is already active!</div>
      <% } %>

        <% if (msg==='notenough' ) { %>
          <div class="alert alert-danger">Not enough pairs to start a match. Need 2 pairs.</div>
          <% } %>

            <% if (msg==='started' ) { %>
              <div class="alert alert-success">Match started successfully!</div>
              <% } %>

  </div>

</body>

</html>